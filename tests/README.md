# ç®€å•å›¾ç‰‡å¯¹æ¯”æµ‹è¯•ç³»ç»Ÿ

## æ¦‚è¿°

ç®€å•å›¾ç‰‡å¯¹æ¯”æµ‹è¯•ç³»ç»Ÿç”¨äºéªŒè¯æ¸²æŸ“å¼•æ“çš„ä¸€è‡´æ€§å’Œæ­£ç¡®æ€§ã€‚è¿™æ˜¯ä¸€ä¸ª**çº¯å•å…ƒæµ‹è¯•**æ–¹æ¡ˆï¼Œä¸ä¿®æ”¹ä»»ä½•ç°æœ‰æºç ï¼Œé€šè¿‡ç‹¬ç«‹è¿è¡Œæ¸²æŸ“ç¨‹åºæ¥å¯¹æ¯”å›¾ç‰‡å·®å¼‚ã€‚

## è®¾è®¡åŸåˆ™

### âœ… **ä¸ä¿®æ”¹ä»»ä½•ç°æœ‰æºç **
- ä¸ä¿®æ”¹ `src/` ç›®å½•ä¸‹çš„ä»»ä½•æ–‡ä»¶
- ä¸ä¿®æ”¹ç°æœ‰çš„æ¸²æŸ“å¼•æ“
- ä¸ä¿®æ”¹ç°æœ‰çš„åè®®è§£æå™¨

### âœ… **ç‹¬ç«‹è¿è¡Œ**
- æµ‹è¯•ç¨‹åºå®Œå…¨ç‹¬ç«‹
- é€šè¿‡ `system()` è°ƒç”¨ç°æœ‰æ¸²æŸ“ç¨‹åº
- åªè´Ÿè´£å¯¹æ¯”å’Œåˆ†æç»“æœ

### âœ… **ç®€å•ç›´æ¥**
- å•ä¸€èŒè´£ï¼šåªåšå›¾ç‰‡å¯¹æ¯”
- æ¸…æ™°çš„å·¥ä½œæµç¨‹
- æ˜“äºç†è§£å’Œç»´æŠ¤

## åŠŸèƒ½ç‰¹æ€§

### ğŸ” **ä¸€è‡´æ€§éªŒè¯**
- **å“ˆå¸Œå€¼æ¯”è¾ƒ**: å¿«é€Ÿæ£€æµ‹å›¾ç‰‡æ˜¯å¦å®Œå…¨ç›¸åŒ
- **åƒç´ çº§å¯¹æ¯”**: ç²¾ç¡®è®¡ç®—å›¾ç‰‡å·®å¼‚ç™¾åˆ†æ¯”
- **å·®å¼‚å¯è§†åŒ–**: ç”Ÿæˆå·®å¼‚å›¾ç‰‡ï¼Œçº¢è‰²æ ‡è®°ä¸åŒåƒç´ 

### ğŸ“Š **æµ‹è¯•ç®¡ç†**
- **åŸºçº¿ç®¡ç†**: è‡ªåŠ¨åˆ›å»ºå’Œæ›´æ–°åŸºçº¿å›¾ç‰‡
- **å®¹å·®è®¾ç½®**: å¯è°ƒèŠ‚çš„å·®å¼‚å®¹å¿åº¦ï¼ˆé»˜è®¤1%ï¼‰
- **æ‰¹é‡æµ‹è¯•**: ä¸€æ¬¡æ€§æµ‹è¯•æ‰€æœ‰é¡¹ç›®

### ğŸ¯ **ä¸€è‡´æ€§æµ‹è¯•**
- **å¤šæ¬¡æ¸²æŸ“**: åŒä¸€åè®®å¤šæ¬¡æ¸²æŸ“ï¼ŒéªŒè¯ç»“æœä¸€è‡´æ€§
- **éšæœºæ€§æ£€æµ‹**: è¯†åˆ«æ¸²æŸ“è¿‡ç¨‹ä¸­çš„éšæœºæ€§
- **ç¡®å®šæ€§éªŒè¯**: ç¡®ä¿æ¸²æŸ“ç»“æœæ˜¯ç¡®å®šæ€§çš„

## ç›®å½•ç»“æ„

```
tests/
â”œâ”€â”€ baseline/           # åŸºçº¿å›¾ç‰‡ç›®å½•
â”‚   â”œâ”€â”€ trip_baseline.png
â”‚   â”œâ”€â”€ food_baseline.png
â”‚   â””â”€â”€ ...
â”œâ”€â”€ diff/              # å·®å¼‚å›¾ç‰‡ç›®å½•
â”œâ”€â”€ simple_image_test.cpp # ç®€å•æµ‹è¯•ç¨‹åº
â””â”€â”€ README.md          # æœ¬æ–‡æ¡£

run_simple_test.sh     # æµ‹è¯•è¿è¡Œè„šæœ¬
SIMPLE_TEST_SUMMARY.md # è¯¦ç»†æ€»ç»“æ–‡æ¡£
```

## ä½¿ç”¨æ–¹æ³•

### 1. è¿è¡Œå®Œæ•´æµ‹è¯•

```bash
# ä½¿ç”¨æµ‹è¯•è„šæœ¬ï¼ˆæ¨èï¼‰
./run_simple_test.sh

# æˆ–ç›´æ¥è¿è¡Œæµ‹è¯•ç¨‹åº
./build/simple_test run
```

### 2. æ›´æ–°åŸºçº¿å›¾ç‰‡

```bash
# æ›´æ–°æŒ‡å®šé¡¹ç›®çš„åŸºçº¿
./build/simple_test update trip
./build/simple_test update food
./build/simple_test update clothes
```

### 3. è®¾ç½®å®¹å·®

```bash
# è®¾ç½®å®¹å·®ä¸º0.5%
./build/simple_test tolerance 0.005

# è®¾ç½®å®¹å·®ä¸º2%
./build/simple_test tolerance 0.02
```

### 4. ä¸€è‡´æ€§æµ‹è¯•

```bash
# æµ‹è¯•æŒ‡å®šé¡¹ç›®çš„ä¸€è‡´æ€§ï¼ˆé»˜è®¤5æ¬¡ï¼‰
./build/simple_test consistency trip

# æŒ‡å®šè¿­ä»£æ¬¡æ•°
./build/simple_test consistency food 10
```

## æµ‹è¯•æµç¨‹

### é¦–æ¬¡è¿è¡Œ
1. ç³»ç»Ÿè‡ªåŠ¨åˆ›å»ºåŸºçº¿å›¾ç‰‡
2. æ‰€æœ‰æµ‹è¯•æ ‡è®°ä¸ºé€šè¿‡
3. åŸºçº¿å›¾ç‰‡ä¿å­˜åœ¨ `tests/baseline/`

### åç»­è¿è¡Œ
1. è¿è¡Œæ¸²æŸ“ç¨‹åºç”Ÿæˆå½“å‰å›¾ç‰‡
2. ä¸åŸºçº¿å›¾ç‰‡å¯¹æ¯”
3. è®¡ç®—å·®å¼‚ç™¾åˆ†æ¯”
4. ç”Ÿæˆå·®å¼‚å›¾ç‰‡ï¼ˆå¦‚æœ‰å·®å¼‚ï¼‰

### å·®å¼‚å¤„ç†
- **å·®å¼‚ â‰¤ å®¹å·®**: æµ‹è¯•é€šè¿‡
- **å·®å¼‚ > å®¹å·®**: æµ‹è¯•å¤±è´¥ï¼Œç”Ÿæˆå·®å¼‚å›¾ç‰‡
- **å“ˆå¸Œå€¼ç›¸åŒ**: å®Œå…¨ä¸€è‡´ï¼Œè·³è¿‡åƒç´ å¯¹æ¯”

## å·¥ä½œåŸç†

### 1. **æ¸²æŸ“é˜¶æ®µ**
```bash
./build/skia projects/trip/trip_protocol.json
# è¾“å‡º: output/trip_rendered.png
```

### 2. **æŸ¥æ‰¾é˜¶æ®µ**
```cpp
// åœ¨ output/ ç›®å½•æŸ¥æ‰¾åŒ…å«é¡¹ç›®åçš„PNGæ–‡ä»¶
if (filename.find("trip") != std::string::npos) {
    currentImagePath = entry.path().string();
}
```

### 3. **å¯¹æ¯”é˜¶æ®µ**
```cpp
// è®¡ç®—å“ˆå¸Œå€¼
std::string currentHash = calculateImageHash(currentImagePath);
std::string baselineHash = calculateImageHash(baselineImagePath);

// å¿«é€Ÿæ¯”è¾ƒ
if (currentHash == baselineHash) {
    return true; // å®Œå…¨ä¸€è‡´
}
```

### 4. **å·®å¼‚åˆ†æ**
```cpp
// åƒç´ çº§æ¯”è¾ƒ
double difference = compareImages(currentImagePath, baselineImagePath);
if (difference <= tolerance) {
    return true; // åœ¨å®¹å·®èŒƒå›´å†…
}
```

## æµ‹è¯•é¡¹ç›®

å½“å‰åŒ…å«çš„æµ‹è¯•é¡¹ç›®ï¼š

| é¡¹ç›® | åè®®æ–‡ä»¶ | æè¿° |
|------|----------|------|
| trip | `projects/trip/trip_protocol.json` | é’æµ·æ¹–æ—…æ¸¸æ”»ç•¥ |
| sunscreen | `projects/sunscreen/sunscreen_protocol.json` | é˜²æ™’æµ·æŠ¥ |
| food | `projects/food/food_protocol.json` | ç¾é£Ÿæµ·æŠ¥ |
| spring | `projects/spring/spring_protocol.json` | æ˜¥å¤©æµ·æŠ¥ |
| dessert | `projects/dessert/dessert_protocol.json` | ç”œå“æµ·æŠ¥ |
| cup | `projects/cup/cup_protocol.json` | æ¯å­æµ·æŠ¥ |
| horizontal | `projects/horizontal/horizontal_protocol.json` | å†¬è‡³æµ·æŠ¥ |
| long | `projects/long/long_protocol.json` | è›‹é»„å¿ƒé•¿å›¾ |
| clothes | `projects/clothes/clothes_protocol.json` | æœè£…æµ·æŠ¥ |

## æœ€ä½³å®è·µ

### 1. **å®šæœŸè¿è¡Œæµ‹è¯•**
```bash
# æ¯æ¬¡ä»£ç ä¿®æ”¹åè¿è¡Œ
./run_simple_test.sh
```

### 2. **åˆç†è®¾ç½®å®¹å·®**
- å°æ”¹åŠ¨ï¼š0.1% - 0.5%
- ä¸­ç­‰æ”¹åŠ¨ï¼š0.5% - 1%
- å¤§æ”¹åŠ¨ï¼š1% - 2%

### 3. **åŠæ—¶æ›´æ–°åŸºçº¿**
```bash
# ç¡®è®¤æ–°ç»“æœæ­£ç¡®åæ›´æ–°åŸºçº¿
./build/simple_test update <project_name>
```

### 4. **æ£€æŸ¥å·®å¼‚å›¾ç‰‡**
- çº¢è‰²åƒç´ è¡¨ç¤ºå·®å¼‚ä½ç½®
- åˆ†æå·®å¼‚åŸå› 
- ç¡®è®¤æ˜¯å¦ä¸ºé¢„æœŸå˜åŒ–

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. æµ‹è¯•ç¨‹åºç¼–è¯‘å¤±è´¥
```bash
# é‡æ–°ç¼–è¯‘
./build.sh
```

#### 2. åŸºçº¿å›¾ç‰‡ä¸å­˜åœ¨
```bash
# ç³»ç»Ÿä¼šè‡ªåŠ¨åˆ›å»ºåŸºçº¿
./build/simple_test run
```

#### 3. å·®å¼‚è¿‡å¤§
- æ£€æŸ¥ä»£ç ä¿®æ”¹
- ç¡®è®¤èµ„æºæ–‡ä»¶å˜åŒ–
- è°ƒæ•´å®¹å·®è®¾ç½®

#### 4. ä¸€è‡´æ€§æµ‹è¯•å¤±è´¥
- æ£€æŸ¥éšæœºæ•°ç”Ÿæˆ
- ç¡®è®¤æ—¶é—´ç›¸å…³ä»£ç 
- éªŒè¯å¤–éƒ¨ä¾èµ–

### è°ƒè¯•æŠ€å·§

#### 1. æŸ¥çœ‹è¯¦ç»†è¾“å‡º
```bash
# è¿è¡Œå•ä¸ªæµ‹è¯•
./build/simple_test consistency trip 1
```

#### 2. æ£€æŸ¥å›¾ç‰‡æ–‡ä»¶
```bash
# æŸ¥çœ‹ç”Ÿæˆçš„å›¾ç‰‡
ls -la output/
ls -la tests/baseline/
ls -la tests/diff/
```

#### 3. åˆ†æå·®å¼‚å›¾ç‰‡
- ä½¿ç”¨å›¾ç‰‡æŸ¥çœ‹å™¨æ‰“å¼€å·®å¼‚å›¾ç‰‡
- çº¢è‰²åŒºåŸŸè¡¨ç¤ºå·®å¼‚ä½ç½®
- å¯¹æ¯”åŸå›¾å’ŒåŸºçº¿å›¾ç‰‡

## æ€§èƒ½ç‰¹ç‚¹

### ä¼˜åŒ–å»ºè®®

1. **å“ˆå¸Œå€¼æ¯”è¾ƒ**: ä¼˜å…ˆä½¿ç”¨å“ˆå¸Œå€¼è¿›è¡Œå¿«é€Ÿæ¯”è¾ƒ
2. **åƒç´ é‡‡æ ·**: å¯¹äºå¤§å›¾ç‰‡ï¼Œå¯ä»¥é‡‡æ ·æ¯”è¾ƒ
3. **å¹¶è¡Œå¤„ç†**: å¤šä¸ªæµ‹è¯•å¯ä»¥å¹¶è¡Œè¿è¡Œ
4. **ç¼“å­˜æœºåˆ¶**: ç¼“å­˜å·²è®¡ç®—çš„å“ˆå¸Œå€¼

### å†…å­˜ä½¿ç”¨

- å¤§å›¾ç‰‡ä¼šå ç”¨è¾ƒå¤šå†…å­˜
- å·®å¼‚å›¾ç‰‡ç”Ÿæˆéœ€è¦é¢å¤–å†…å­˜
- å»ºè®®åˆ†æ‰¹å¤„ç†å¤§é‡æµ‹è¯•

---

**ç¡®ä¿æ¸²æŸ“è´¨é‡ï¼Œç»´æŠ¤ä»£ç ç¨³å®šæ€§ï¼** ğŸ¨âœ¨ 